(()=>{"use strict";const e="1WN8151jGQjqbfO0Aj2tK-79yJ9gCD_z0DLCdxs_higg",t=["Sensex ▲","NIFTY50 ▲","Brent Crude ▼","USD/INR ↔","Gold (MCX) ▲","India VIX ▼"],n=["Mutual fund SIP inflows hit record","RBI policy unchanged","GST collection beats estimates"],o=(e,t,n)=>`https://docs.google.com/spreadsheets/d/${e}/gviz/tq?tqx=out:csv&headers=1&sheet=${encodeURIComponent(t)}&range=${encodeURIComponent(n)}&t=${Date.now()}`,r=e=>{if((e||"").trim().startsWith("<"))return{rows:[],isHtml:!0};const t=[];let n=[],o="",r=!1;for(let s=0;s<e.length;s++){const i=e[s];if(r)'"'===i?'"'===e[s+1]?(o+='"',s++):r=!1:o+=i;else if('"'===i)r=!0;else if(","===i)n.push(o),o="";else if("\n"===i)n.push(o),t.push(n),n=[],o="";else"\r"!==i&&(o+=i)}return(o.length>0||n.length>0)&&(n.push(o),t.push(n)),{rows:t,isHtml:!1}},s=async(t,n)=>{const s=await fetch(o(e,t,n),{cache:"no-store"});if(!s.ok)throw new Error("Sheet fetch failed: "+t);const i=await s.text(),{rows:c,isHtml:l}=r(i);if(l)throw new Error("Not CSV (publish-to-web missing?)");if(!c.length)return[];const a=c[0].map((e=>e.replace(/^\uFEFF/,"").replace(/\u00A0/g," ").trim()));return c.slice(1).filter((e=>e.some((e=>(""!==(null==e?void 0:e.toString().trim())))))).map((e=>Object.fromEntries(a.map(((t,n)=>[t,(e[n]??"").toString().trim()])))))},i=e=>{const t=(null==e?void 0:e.parentElement)?.clientWidth||0;if(!t||!e)return;for(;e.scrollWidth<t*2;)[...e.children].forEach((t=>e.appendChild(t.cloneNode(!0))))},c=(e,o,r="right")=>{const s=document.getElementById(e);if(!s)return;s.classList.remove("ticker-left","ticker-right"),s.innerHTML="";const l=o&&o.length?o:"topTicker"===e?t:n;[...l,...l].forEach((e=>{const t=document.createElement("span");t.textContent=String(e||"").trim(),s.appendChild(t)})),i(s),void s.offsetWidth,s.classList.add("right"===r?"ticker-right":"ticker-left","ticker")},l=async()=>{try{const e=await s("Headlines","A:B"),o=e.filter((e=>/^top$/i.test(e.Section||""))).map((e=>e.Text)).filter(Boolean),r=e.filter((e=>/^bottom$/i.test(e.Section||""))).map((e=>e.Text)).filter(Boolean);o.length&&c("topTicker",o,"right"),r.length&&c("bottomTicker",r,"left")}catch(e){console.warn("Headlines error",e?.message||e),c("topTicker",t,"right"),c("bottomTicker",n,"left")}},a=()=>{const e=document.getElementById("year");e&&(e.textContent=(new Date).getFullYear())},d=()=>{let e;window.addEventListener("resize",(()=>{cancelAnimationFrame(e),e=requestAnimationFrame((()=>{i(document.getElementById("topTicker")),i(document.getElementById("bottomTicker"))}))}))},u=()=>{a(),c("topTicker",t,"right"),c("bottomTicker",n,"left"),l();const e=setInterval(l,3e5);window.addEventListener("pagehide",(()=>clearInterval(e))),d()};document.addEventListener("DOMContentLoaded",u)})();
