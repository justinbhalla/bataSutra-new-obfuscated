(()=>{"use strict";const t="1WN8151jGQjqbfO0Aj2tK-79yJ9gCD_z0DLCdxs_higg",e=["Sensex ▲","NIFTY50 ▲","Brent Crude ▼","USD/INR ↔","Gold (MCX) ▲","India VIX ▼"],n=["Mutual fund SIP inflows hit record","RBI policy unchanged","GST collection beats estimates"],r=(t,e,n)=>`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?tqx=out:csv&headers=1&sheet=${encodeURIComponent(e)}&range=${encodeURIComponent(n)}&t=${Date.now()}`,o=t=>{if(((t??"").trim()).startsWith("<"))return{rows:[],isHtml:!0};const e=[];let n=[],r="",o=!1;for(let i=0;i<t.length;i++){const l=t[i];if(o)'"'===l?'"'===t[i+1]?(r+='"',i++):o=!1:r+=l;else if('"'===l)o=!0;else if(","===l)n.push(r),r="";else if("\n"===l)n.push(r),e.push(n),n=[],r="";else"\r"!==l&&(r+=l)}return(r.length>0||n.length>0)&&(n.push(r),e.push(n)),{rows:e,isHtml:!1}},i=async(e,n)=>{const i=await fetch(r(t,e,n),{cache:"no-store"});if(!i.ok)throw new Error("Sheet fetch failed: "+e);const l=await i.text(),{rows:a,isHtml:s}=o(l);if(s)throw new Error("Not CSV (publish-to-web missing?)");if(!a.length)return[];const c=a[0].map((t=>t.replace(/^\uFEFF/,"").replace(/\u00A0/g," ").trim()));return a.slice(1).filter((t=>t.some((t=>(""!==(t??"").toString().trim()))))).map((t=>Object.fromEntries(c.map(((e,n)=>[e,(t[n]??"").toString().trim()])))))},l=t=>{const e=t?.parentElement?.clientWidth||0;if(!e||!t)return;for(;t.scrollWidth<2*e;)[...t.children].forEach((e=>t.appendChild(e.cloneNode(!0))))},a=(t,r,o="right")=>{const i=document.getElementById(t);if(!i)return;i.classList.remove("ticker-left","ticker-right"),i.innerHTML="";const s=r&&r.length?r:"topTicker"===t?e:n;[...s,...s].forEach((t=>{const e=document.createElement("span");e.textContent=String(t||"").trim(),i.appendChild(e)})),l(i),void i.offsetWidth,i.classList.add("right"===o?"ticker-right":"ticker-left","ticker")},s=async()=>{try{const t=await i("Headlines","A:B"),r=t.filter((t=>/^top$/i.test(t.Section||""))).map((t=>t.Text)).filter(Boolean),o=t.filter((t=>/^bottom$/i.test(t.Section||""))).map((t=>t.Text)).filter(Boolean);r.length&&a("topTicker",r,"right"),o.length&&a("bottomTicker",o,"left")}catch(t){console.warn("Headlines error",t?.message||t),a("topTicker",e,"right"),a("bottomTicker",n,"left")}},c=()=>{const t=document.getElementById("year");t&&(t.textContent=(new Date).getFullYear())},d=()=>{let t;window.addEventListener("resize",(()=>{cancelAnimationFrame(t),t=requestAnimationFrame((()=>{l(document.getElementById("topTicker")),l(document.getElementById("bottomTicker"))}))}))},u=()=>{c(),a("topTicker",e,"right"),a("bottomTicker",n,"left"),s();const t=setInterval(s,3e5);window.addEventListener("pagehide",(()=>clearInterval(t))),d()};document.addEventListener("DOMContentLoaded",u)})();
