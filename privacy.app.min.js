!function(){"use strict";
/* ===== cfg ===== */
var A="1WN8151jGQjqbfO0Aj2tK-79yJ9gCD_z0DLCdxs_higg",B="Headlines",C="A:C",D="https://docs.google.com/spreadsheets/d/"+A+"/gviz/tq?tqx=out:csv&sheet="+encodeURIComponent(B)+"&range="+encodeURIComponent(C);
/* prefetch (best-effort) */
try{var pf=document.createElement("link");pf.rel="prefetch",pf.href=D,pf.as="fetch",pf.crossOrigin="anonymous",document.head.appendChild(pf);}catch(_){}
/* tiny CSV */
function E(t){var r=[],n=[],e="",i=!1,o,a=0;for(a=0;a<t.length;a++)if(o=t[a],i)'"'!==o?e+=o:'"'===t[a+1]?(e+='"',a++):i=!1;else if('"'===o)i=!0;else if(","===o)n.push(e),e="";else if("\n"===o)n.push(e),r.push(n),n=[],e="";else"\r"!==o&&(e+=o);return(e.length||n.length)&&(n.push(e),r.push(n)),r}
/* cache */
var F="bs_headlines_v2",G=9e5;function H(){try{var t=localStorage.getItem(F);if(!t)return null;var r=JSON.parse(t);return Date.now()-r.ts>G?null:r.d}catch(t){return null}}function I(t){try{localStorage.setItem(F,JSON.stringify({ts:Date.now(),d:t}))}catch(t){}}
/* fetch+timeout */
function J(t,r,n){r=r||{};var e=700;return n&&n>0&&(e=n),new Promise(function(n,i){var o=new(window.AbortController||function(){this.abort=function(){}}),a=setTimeout(function(){try{o.abort()}catch(t){}i(new Error("timeout"))},e);(window.fetch||function(){return Promise.reject(new Error("fetch missing"))})(t,{cache:"force-cache",credentials:"omit",signal:o.signal}).then(function(t){clearTimeout(a),n(t)}).catch(function(t){clearTimeout(a),i(t)})})}
/* headlines → [{section,text}] | null */
function K(){return J(D,{},700).then(function(t){if(!t.ok)throw new Error("HTTP "+t.status);return t.text()}).then(function(t){if((t||"").trim().indexOf("<")===0)return[];var r=E(t);if(!r.length)return[];var n=r[0].map(function(t){return t.replace(/^\uFEFF/,"").trim().toLowerCase()}),e=n.indexOf("section"),i=n.indexOf("text");return e<0||i<0?[]:r.slice(1).map(function(t){return{section:(t[e]||"").toLowerCase().trim(),text:(t[i]||"").trim()}}).filter(function(t){return!!t.text})}).catch(function(){return null})}
/* ticker duration by content length */
function L(t,r){var n=(r||[]).join(" • ").length||120,e=Math.min(140,Math.max(60,Math.round(n/1.8)));try{t.style.setProperty("--dur",e+"s")}catch(_){t.style&&(t.style.animationDuration=e+"s")}}
/* render ticker */
function M(t,r,n){if(!t||!r||!r.length)return;t.className="ticker "+("right"===n?"ticker-right":"ticker-left")+" "+("botTicker"===t.id?"text-sm text-slate-700":"text-sm font-medium"),t.innerHTML="";for(var e=r.concat(r),i=0;i<e.length;i++){var o=document.createElement("span");o.textContent=e[i],t.appendChild(o)}L(t,r)}
/* paint both rails */
function N(t){if(!t)return;for(var r=[],n=[],e=0;e<t.length;e++)"top"===t[e].section?r.push(t[e].text):"bottom"===t[e].section&&n.push(t[e].text);var i=document.getElementById("topTicker"),o=document.getElementById("botTicker");r.length&&M(i,r,"right"),n.length&&M(o,n,"left")}
/* boot */
function O(){var t=document.getElementById("year");t&&(t.textContent=(new Date).getFullYear().toString());try{if(window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches){for(var r=document.querySelectorAll(".ticker-left,.ticker-right"),n=0;n<r.length;n++)r[n].style.animation="none"}}catch(_){}
var e=H();e&&N(e),K().then(function(t){t&&(I(t),N(t))})}
document.addEventListener("DOMContentLoaded",O);
}();
